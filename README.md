# FastGPT + Ollama + DeepSeek-R1 æœ¬åœ°ç¯å¢ƒæœ€ä½³å®è·µ

åŸºäºå¼€æºå¹³å° [FastGPT](https://github.com/labring/FastGPT/tree/main) å’Œå¼€æºå¤§æ¨¡å‹ [DeepSeek R1](https://ollama.com/library/deepseek-r1) åœ¨æœ¬åœ°ç¯å¢ƒæ­å»ºå’ŒçŸ¥è¯†åº“å’Œé—®ç­”å¹³å°çš„æœ€ä½³å®è·µã€‚æä¾›å¼€ç®±å³ç”¨çš„æ•°æ®å¤„ç†ã€æ¨¡å‹è°ƒç”¨ç­‰èƒ½åŠ›ã€‚åŒæ—¶å¯ä»¥é€šè¿‡ Flow å¯è§†åŒ–è¿›è¡Œå·¥ä½œæµç¼–æ’ï¼Œä»è€Œå®ç°å¤æ‚çš„é—®ç­”åœºæ™¯ï¼
</div>

## æœ¬åœ°è®¾å¤‡é…ç½®åŠæ¨¡å‹ç‰ˆæœ¬
- #### æœ¬åœ°è®¾å¤‡é…ç½®
    -  æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼šMacOS Sequoia 15.2
    - å¤„ç†å™¨ï¼šå¤„ç†å™¨ 2.9GHz å…­æ ¸ Intel Core i9
    - å›¾å½¢å¡ï¼š Intel UHD Graphics 630 1536 MB
    - å†…å­˜ï¼š32 GB 2400 MHz DDR4
    - ç£ç›˜ï¼š500G
    - Docker Desktop: 4.38.0 ï¼ˆå¦‚æœå®‰è£…äº†æ¡Œé¢ç‰ˆï¼Œdocker å’Œ docker compose ä¸ç”¨å†å•ç‹¬å®‰è£…ï¼‰
    - Docker: 27.5.1
    - Docker Compose: v2.32.4-desktop.1
- #### æ¡†æ¶åŠæ¨¡å‹ç‰ˆæœ¬
    - FastGPT: [v4.9.3](https://github.com/labring/FastGPT/pkgs/container/fastgpt/383840341?tag=v4.9.3)
        >  æ¨¡å‹ç®¡ç†ã€æ•°æ®é¢„å¤„ç†åŠRAGé…ç½®ã€çŸ¥è¯†åº“ç®¡ç†åŠå·¥ä½œæµç¼–æ’çš„å¯è§†åŒ–å¼€æºå¹³å°
    - AIProxy: [v0.1.5](https://github.com/labring/aiproxy/pkgs/container/aiproxy/383652347?tag=v0.1.5)
        > åŸºäºOpenAI æ ‡å‡†è§„èŒƒçš„ AI ç½‘å…³ï¼Œå¯ä»¥å¿«é€Ÿè°ƒç”¨å¸¸ç”¨æ¨¡å‹
    - Ollama: [latest](https://hub.docker.com/r/ollama/ollama/tags)
        > é€‚åˆæœ¬åœ°ç¯å¢ƒçš„å¤§è¯­è¨€æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯å¿«æ·è¿›è¡Œä¸‹è½½ã€é…ç½®ã€å¯åŠ¨ã€åˆ é™¤ç­‰å¸¸ç”¨æ“ä½œ
    - DeepSeekR1: [deepseek-r1:7b](https://ollama.com/library/deepseek-r1)
        > ç›®å‰æœ€ç«çˆ†çš„å¼€æºçš„æ·±åº¦æ€è€ƒå¤§è¯­è¨€æ¨¡å‹ä¹‹ä¸€ï¼Œ7b æœ€å°‘éœ€è¦8Gä»¥ä¸Šçš„å†…å­˜ï¼Œå¦‚æœè®¾å¤‡é…ç½®è¾ƒä½ï¼Œå¯ä»¥ä¿®æ”¹ compose æ–‡ä»¶ ollama æœåŠ¡ä¸‹çš„ç¯å¢ƒå˜é‡ `TO_PULL_MODELS` å’Œ `TO_RUN_MODELS` æ¥é€‰æ‹©1.5bçš„ç‰ˆæœ¬
    - Gemma3: [gemma3:1b](https://ollama.com/library/gemma3)
        > Google å¼€æºçš„å¯ç”¨è¿›è¡Œæ–‡æœ¬å¤„ç†åŠå›¾ç‰‡ç†è§£çš„è½»é‡çº§å¤§æ¨¡å‹ï¼Œå› ä¸ºFastGPT å¼€æºç‰ˆæœ¬ä¸æ”¯æŒåˆ›å»ºå›¾ç‰‡ç´¢å¼•å’Œè¡¥å……ç´¢å¼•ï¼Œæ‰€ä»¥Demoåªæ˜¯æ”¯æŒè¿™ç±»æ¨¡å‹çš„é…ç½®ï¼Œå®é™…åˆ›å»ºçŸ¥è¯†åº“æ—¶å¯ä»¥é…ç½®è¯¥æ¨¡å‹ä½†æ²¡æ³•åˆ›å»ºç´¢å¼•ã€‚**å¦‚æœä¸éœ€è¦æˆ–è€…è®¾å¤‡é…ç½®æœ‰é™å¯ä»¥ç›´æ¥ä»compose é…ç½®ä¸­åˆ é™¤è¯¥æ¨¡å‹**ï¼Œå¯ä»¥ä¿®æ”¹ compose æ–‡ä»¶ ollama æœåŠ¡ä¸‹çš„ç¯å¢ƒå˜é‡ `TO_PULL_MODELS` å’Œ `TO_RUN_MODELS`ã€‚
    - Embedding: [nomic-embed-text](https://ollama.com/library/nomic-embed-text)
        > è‡ªå®šä¹‰é…ç½®çš„å†…åµŒæ¨¡å‹

## å¿«é€Ÿå¯åŠ¨å„æœåŠ¡åŠé…ç½®
- ä¸€é”®å¯åŠ¨æ¡†æ¶å¹³å°åŠæ¨¡å‹æœåŠ¡ ï¼ˆ**å¦‚æœåœ¨ä¸­å›½å¤§é™†è®¿é—®è¯·æå‰é…ç½®å¥½VPN**ï¼‰
    ```shell
        docker compose -f docker-compose.yml  up -d
    ```
- é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œå› ä¸ºè¦ä¸‹è½½å¤§æ¨¡å‹å’Œå„é•œåƒæ–‡ä»¶ï¼Œéœ€è¦èŠ±è´¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œå¦‚æœæ˜¯ä¸‹è½½ DeepseekR1:7b éœ€è¦5-10åˆ†é’Ÿ
    > æ‰§è¡Œå®Œæˆåå¯ä»¥é€šè¿‡ `docker logs -f --tail=100 ollama` è§‚å¯Ÿå¯åŠ¨æ—¥å¿—ï¼Œçœ‹æ¨¡å‹æ–‡ä»¶æ˜¯å¦å·²ç»ä¸‹è½½å®Œæˆï¼Œå¹¶ä¸”å®Œæˆå¯åŠ¨æˆåŠŸã€‚å¦‚æœå‡ºç° `å¯åŠ¨æ¨¡å‹æœåŠ¡: xxx` ä¹‹ç±»çš„æ—¥å¿—å¹¶ä¸”æ²¡æœ‰æŠ¥é”™è¯´æ˜æ¨¡å‹ä¸‹è½½å¹¶å¯åŠ¨å®Œæˆäº†ã€‚å¯ä»¥æ‰§è¡Œ `docker exec -it ollama sh` -> `ollama list`  çœ‹ä¸‹è½½äº†å“ªäº›æ¨¡å‹ï¼Œ`ollama ps` çœ‹å·²ç»è¿è¡ŒæˆåŠŸäº†å“ªäº›æ¨¡å‹ã€‚
- æ‰€æœ‰æœåŠ¡å¯åŠ¨åï¼Œå°±æœ‰ä¸€äº›åœ°å€å¯ä»¥è®¿é—®ï¼š
    - FastGPT å¹³å°ï¼šhttp://localhost:3000
    - AI Proxy Swaggerï¼šhttp://localhost:3001/swagger/index.html
- æ¥ä¸‹æ¥å¼€å§‹é…ç½®è‡ªå®šä¹‰æ¨¡å‹ï¼š
    - ç™»å½• FastGPT å¹³å°ï¼Œé»˜è®¤è´¦å· `root` å¯†ç ä¸ºï¼š`1234`
    - è´¦å· -> æ¨¡å‹æä¾›å•† -> æ¨¡å‹æ¸ é“ -> æ·»åŠ æ¸ é“ -> Ollama æ¸ é“ï¼Œå¹¶æ·»åŠ é…ç½®ï¼Œå¦‚å›¾ï¼š
        > <img height="200" width="300" src="./chanel_config_zh.jpeg">

    - è´¦å· -> æ¨¡å‹æä¾›å•† -> æ¨¡å‹é…ç½® -> æ·»åŠ æ¨¡å‹ï¼Œåˆ†åˆ«æ·»åŠ ä¸¤ä¸ªè¯­è¨€æ¨¡å‹ `ds-r1`, `my-gemma3-1b` å’Œç´¢å¼•æ¨¡å‹ `my-embed-nomic`ï¼Œ ç´¢å¼•æ¨¡å‹éœ€è¦å•ç‹¬é…ç½®è°ƒç”¨APIã€‚å¦‚å›¾ï¼š 
        > <img height="200" width="300" src="./add_model.png">  <img height="200" width="300" src="./add_index_model.png">
    - å°†æ–°å¢çš„3ä¸ªæ¨¡å‹åœ¨ `Ollama æ¸ é“` ç¼–è¾‘ä¸­æ·»åŠ è¿›æ¥åï¼Œå°±è·Ÿç¬¬ä¸€å¼ å›¾çš„ç»“æœä¸€æ ·äº†
    - æ¨¡å‹æµ‹è¯•ï¼šå¯ä»¥åœ¨ `æ¨¡å‹æ¸ é“` é‡Œé€‰æ‹© `Ollama` å¹¶ğŸˆ¯ï¸æµ‹è¯•æ¨¡å‹ï¼Œè¿”å›æˆåŠŸè¡¨ç¤ºæ¨¡å‹è¿é€šï¼Œ ä¹Ÿå¯ä»¥åœ¨æ¨¡å‹é…ç½®ç•Œé¢é€‰æ‹©å¯¹åº”çš„æ¨¡å‹è¿›è¡Œæµ‹è¯•ã€‚
    - åˆ›å»ºè‡ªå·±çš„çŸ¥è¯†åº“ï¼šçŸ¥è¯†åº“ -> æ–°å»ºï¼Œå…ˆåˆ›å»ºè‡ªå·±çš„ä¸€ä¸ªè¯­æ–™é›†åˆï¼Œç„¶åå†æ·»åŠ è‡ªå·±çš„çŸ¥è¯†åº“æ–‡ä»¶ï¼Œé€‰æ‹©åˆé€‚çš„åˆ†æ®µç­–ç•¥ï¼Œç„¶ååœ¨ç¡®è®¤ï¼Œåœ¨å³ä¾§å°±å¯ä»¥çœ‹åˆ°å’Œé€‰æ‹©å¯¹åº”çš„ `ç´¢å¼•æ¨¡å‹`,`æ–‡æœ¬ç†è§£æ¨¡å‹`,`å›¾ç‰‡ç†è§£æ¨¡å‹`ï¼ŒçŠ¶æ€ä¸º `å·²å°±ç»ª`è¡¨æ˜é‡æ–°åˆ›å»ºç´¢å¼•å®Œæˆã€‚å¯ä»¥é€šè¿‡ `æœç´¢æµ‹è¯•` èœå•è¿›è¡Œæµ‹è¯•ã€‚è¿™é‡Œå¯ä»¥è¡¥å……ä½ å·²ç»æœ‰ç¦»çº¿è¯­æ–™ï¼Œå¹¶è¿›è¡Œåˆç†çš„é…ç½®åé‡æ–°åˆ›å»ºç´¢å¼•ã€‚
    - åˆ›å»ºè‡ªå·±çš„ChatAPP åº”ç”¨ï¼šå·¥ä½œå° -> åˆ›å»º -> ç®€æ˜“åº”ç”¨ -> `First APP`: å¯ä»¥é€‰æ‹©å¯¹åº”çš„è¯­è¨€æ¨¡å‹ï¼Œé…ç½®ç›¸å…³çš„çŸ¥è¯†åº“åŠå…¶å®ƒå‚æ•°ï¼Œåœ¨å³ä¾§å¯ä»¥å‘é€æ¶ˆæ¯æµ‹è¯•ã€‚æˆåŠŸåç‚¹å‡»å³ä¸Šè§’ä¿å­˜ã€‚
    - æµ‹è¯•èŠå¤©æœåŠ¡ï¼šèŠå¤© -> é€‰æ‹©å¯¹åº”çš„åº”ç”¨ï¼Œå¯ä»¥è¿›è¡ŒèŠå¤©äº†ï¼Œçª—å£é¡¶éƒ¨å¯ä»¥å±•ç¤ºå¯¹åº”çš„ä½¿ç”¨æ¨¡å‹ä¿¡æ¯ã€‚

## ç›¸å…³å¼•ç”¨
- [FastGPT](https://github.com/labring/FastGPT)
- [AI Proxy](https://github.com/labring/aiproxy)
- [Ollama](https://github.com/ollama/ollama)
- [DeepSeek](https://github.com/deepseek-ai/DeepSeek-R1)
- [Gemma3](https://ollama.com/library/gemma3)
